$(document).ready(function() {
  if($("#data_cards").length) {
    initDataCardsPage();
  }
});

function initDataCardsPage() {

  var 
  favorites = new CarrouselData("Favorites",99,4),	
  core = new CarrouselData("Core",99,1),	
  supporting = new CarrouselData("Supporting",99,2),	
  annotations = new CarrouselData("Annotations",99,1);

  [favorites, core, supporting, annotations].forEach(function(element) {
    element.addFilter("data-category-collecting_event");
    element.addFilter("data-category-Taxon_name");
    element.addFilter("data-category-source");
    element.addFilter("data-category-collection_object");
    element.filterChilds();
  });

  function changeAllSectionsFilter(dataTag, value) {
   core.setFilterStatus(dataTag,value);
   supporting.setFilterStatus(dataTag,value);
   annotations.setFilterStatus(dataTag,value);
 }


  //Getting clicks on arrows 


  $('.data_card').mousedown(function(event) {
  	if((event.which) == 1) {
     location.href = $(this).children("a").attr('href');
   }
 });    


  $('#filter [data-filter-category="taxon_name"]').on('click', function() {
   core.changeFilter("data-category-taxon_name");
   supporting.changeFilter("data-category-taxon_name");
   annotations.changeFilter("data-category-taxon_name");
   favorites.changeFilter("data-category-taxon_name"); 
 });  

  $('#filter [data-filter-category="collecting_event"]').on('click', function() {
   core.changeFilter("data-category-collecting_event"); 
   supporting.changeFilter("data-category-collecting_event"); 
   annotations.changeFilter("data-category-collecting_event"); 
   favorites.changeFilter("data-category-collecting_event");
 });

  $('#filter [data-filter-category="collection_object"]').on('click', function() {
   core.changeFilter("data-category-collection_object");   
   supporting.changeFilter("data-category-collection_object");   
   annotations.changeFilter("data-category-collection_object"); 
   favorites.changeFilter("data-category-collection_object");
 });  

  $('#filter [data-filter-category="source"]').on('click', function() {  	
   core.changeFilter("data-category-source");
   supporting.changeFilter("data-category-source");
   annotations.changeFilter("data-category-source");
   favorites.changeFilter("data-category-source");
 });


  $('#filter [data-filter-category="reset"]').on('click', function() {
    changeAllSectionsFilter("data-category-source", false);
    changeAllSectionsFilter("data-category-taxon_name", false);
    changeAllSectionsFilter("data-category-collection_object", false);
    changeAllSectionsFilter("data-category-collecting_event", false);
  });  

  $('.data_card div[data-category-collecting_event="true"]').append("<img src='<%= asset_path('geo_location.svg') %>'/>");
  $('.data_card div[data-category-taxon_name="true"]').append("<img src='<%= asset_path('new.svg') %>'/>");
  $('.data_card div[data-category-collection_object="true"]').append("<img src='<%= asset_path('picking.svg') %>'/>");
  $('.data_card div[data-category-source="true"]').append("<img src='<%= asset_path('book.svg') %>'/>");   

}