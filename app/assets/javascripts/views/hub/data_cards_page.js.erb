$(document).ready(function() {
  if($("#data_cards").length) {
    initDataCardsPage();
  }
});

function initDataCardsPage() {

  var 
  favorites = new CarrouselData("Favorites",99,4),	
  core = new CarrouselData("Core",99,1),	
  supporting = new CarrouselData("Supporting",99,2),	
  annotations = new CarrouselData("Annotations",99,1);

  [favorites, core, supporting, annotations].forEach(function(element) {
    element.addFilter("data-category-collecting_event");
    element.addFilter("data-category-Taxon_name");
    element.addFilter("data-category-source");
    element.addFilter("data-category-collection_object");
    element.addFilter("data-category-biology");
    element.filterChilds();
  });

  function changeAllSectionsFilter() {
  [favorites, core, supporting, annotations].forEach(function(element) {
    element.resetFilters();
  });
 }

  $('.data_card').mousedown(function(event) {
  	if((event.which) == 1) {
     location.href = $(this).children("a").attr('href');
   }
 });    

  $('#filter [data-filter-category]').on('click', function() {
    var
    elementFilter = $(this).attr('data-filter-category');
    if(elementFilter === "reset") {
      changeAllSectionsFilter("data-category-source", false);
      changeAllSectionsFilter("data-category-taxon_name", false);
      changeAllSectionsFilter("data-category-collection_object", false);
      changeAllSectionsFilter("data-category-collecting_event", false);
      changeAllSectionsFilter("data-category-biology", false);
    }
    else {
      [favorites, core, supporting, annotations].forEach(function(element) {
        element.changeFilter("data-category-"+ elementFilter);
      });
    }
  });  

  $('.data_card div[data-category-collecting_event="true"]').append("<img src='<%= asset_path('geo_location.svg') %>'/>");
  $('.data_card div[data-category-taxon_name="true"]').append("<img src='<%= asset_path('new.svg') %>'/>");
  $('.data_card div[data-category-collection_object="true"]').append("<img src='<%= asset_path('picking.svg') %>'/>");
  $('.data_card div[data-category-source="true"]').append("<img src='<%= asset_path('book.svg') %>'/>");   

}